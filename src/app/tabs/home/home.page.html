<ion-header>
  <ion-toolbar>
    <!-- View/Change active location -->
    <ion-row id="row_location_dropdown" class="ion-align-items-center" (click)="openMarketplaceLocations()">
      <ion-col size="auto">
        <ion-icon id="icon_pin_location" color="primary" name="location-sharp"></ion-icon>
      </ion-col>
      <ion-col>
        <p>{{city?.Name}}, {{county?.Name}}</p>
      </ion-col>
      <ion-col size="auto">
        <ion-icon name="chevron-down-outline"></ion-icon>
      </ion-col>
    </ion-row>
    <!-- Search product/category -->
    <ion-searchbar mode="ios" placeholder="Cauta produs sau categorie" inputmode="text"
      (ionChange)="onSearchChange($event.target.value)" [debounce]="250"></ion-searchbar>
  </ion-toolbar>
</ion-header>

<ion-content>
  <!-- Section Promotions Carousel -->
  <!-- <ion-slides mode="ios">
    <ion-slide>
      <h1>Awesome Slide Content</h1>
    </ion-slide>
  </ion-slides> -->

  <!-- Section MetaCategories List -->
  <div id="metacategories_list" *ngIf="metacategories && !searchResult">
    <!-- List Header: title & toggle view -->
    <ion-row class="ion-align-items-center section_header">
      <ion-col>
        <p class="section_title">Categorii</p>
      </ion-col>
      <ion-col size="auto">
        <ion-button color="primary" fill="clear" shape="round" size="small"
          (click)="toggleViewMode('metacategoriesList')">
          {{showAllMetacategories ? 'Vezi mai putin' : 'Vezi toate'}}
        </ion-button>
      </ion-col>
    </ion-row>
    <div [class]="showAllMetacategories ? 'wrap_vertical_list' : 'wrap_horizontal_list'"
      [@listAnimation]="metacategories.length">
      <ion-card button class="cardview_metacategory" [class]="activeCategory == category ? 'active_selection' : ''"
        *ngFor="let category of metacategories" [style.background]="category.heroPicture ? 'url('+category.heroPicture+')' : 'url(\'../../../assets/icon/icon_food_marketplace_dark.svg\')'"
        (click)="selectMetacategory(category)">
        <div class="wrap_category_title">
          <p>{{category.name}}</p>
        </div>
      </ion-card>
      <ion-card button class="cardview_metacategory" (click)="showAllMetacategories = !showAllMetacategories">
        
      </ion-card>
    </div>
  </div>

  <!-- Section Vendors List -->
  <div id="vendors_list" *ngIf="vendorsList && !searchResult">
    <!-- List Header: title & toggle view -->
    <ion-row class="ion-align-items-center section_header">
      <ion-col>
        <p class="section_title">Producatori</p>
      </ion-col>
      <ion-col size="auto">
        <ion-button color="primary" fill="clear" shape="round" size="small" (click)="toggleViewMode('vendorsList')">
          {{showAllVendors ? 'Mai putin' : 'Mai mult'}}
        </ion-button>
      </ion-col>
    </ion-row>

    <div [class]="showAllVendors ? 'wrap_vertical_list' : 'wrap_horizontal_list'" *ngIf="vendorsList"
      [@listAnimation]="vendorsList.slice(0, 5).length">
      <ion-card button class="cardview_vendor"
        *ngFor="let vendor of showAllVendors ? (vendorsList | filterByMetacategory : activeCategory) : vendorsList.slice(0, 5)"
        (click)="selectVendor(vendor)">
        <div class="header_cardview_vendor" [style.background]="vendor.heroPicture ? 'url('+vendor.heroPicture+')' : 'url(\'../../../assets/icon/icon_food_marketplace_dark.svg\')'">
          <ion-row class="row_vendor_name">
            <ion-col size="auto">
              <div class="wrap_vendor_logo">
                <img [src]="vendor.imageUrl" [alt]="vendor.name">
              </div>
            </ion-col>
            <ion-col>
              <div class="wrap_vendor_name">
                <p>{{vendor.name}}</p>
              </div>
            </ion-col>
          </ion-row>
        </div>
        <div class="container_cardview_vendor">
          <p class="label_vendor_main_category">{{vendor.title}}</p>
          <p class="label_available_products">{{vendor.productsInStock}} produse</p>
          <ion-row>
            <ion-col size="6">
              <p class="lable_minimum_order">
                <span>{{vendor.minimumOrderValue | currency:localeData?.currency:'symbol-narrow':'.0-2':localeData?.localeID}}</span>
                cos minim</p>
            </ion-col>
            <ion-col size="6">
              <p class="label_cashback_value"><span>{{vendor.cashback}}</span> cashback</p>
            </ion-col>
          </ion-row>
        </div>
      </ion-card>
      <!-- View more button -->
      <ion-card button id="button_view_more" class="cardview_vendor" *ngIf="!showAllVendors"
        (click)="showAllVendors = true; activeCategory = null">
        <ion-row class="ion-align-items-center">
          <ion-col size="9">
            <div>
              <p>Vezi toti producatorii</p>
            </div>
          </ion-col>
          <ion-col size="3">
            <ion-icon color="tertiary" name="chevron-forward-outline"></ion-icon>
          </ion-col>
        </ion-row>
      </ion-card>
    </div>
  </div>

  <!-- Section Promotions -->
  <div id="vendors_promo_list" *ngIf="vendorsWithActivePromotions && !searchResult">
    <ion-row class="ion-align-items-center section_header">
      <ion-col>
        <p class="section_title">Promotii</p>
      </ion-col>
      <ion-col size="auto">
        <ion-button color="primary" fill="clear" shape="round" size="small"
          (click)="toggleViewMode('vendorsPromoList')">
          {{showAllVendorsPromo ? 'Vezi mai putin' : 'Vezi toate'}}
        </ion-button>
      </ion-col>
    </ion-row>
    <div [class]="showAllVendorsPromo ? 'wrap_vertical_list' : 'wrap_horizontal_list'" [@listAnimation]="6">
      <ion-card button class="cardview_vendor" (click)="selectVendor(vendor)"
        *ngFor="let vendor of vendorsWithActivePromotions">
        <div class="header_cardview_vendor">
          <ion-row class="row_vendor_name">
            <ion-col size="auto">
              <div class="wrap_vendor_logo">
                <img [src]="vendor.imageUrl" [alt]="vendor.name">
              </div>
            </ion-col>
            <ion-col>
              <div class="wrap_vendor_name">
                <p>{{vendor.name}}</p>
              </div>
            </ion-col>
          </ion-row>
        </div>
        <div class="container_cardview_vendor">
          <p class="label_vendor_main_category">{{vendor.title}}</p>
          <p class="label_available_products">{{vendor.productsInStock}} produse</p>
          <ion-row>
            <ion-col size="6">
              <p class="lable_minimum_order">
                <span>{{vendor.minimumOrderValue | currency:localeData?.currency:'symbol-narrow':'.0-2':localeData?.localeID}}</span>
                cos minim</p>
            </ion-col>
            <ion-col size="6">
              <p class="label_cashback_value"><span>{{vendor.cashback}}</span> cashback</p>
            </ion-col>
          </ion-row>
        </div>
      </ion-card>
      <!-- View more button -->
      <!-- <ion-card button id="button_view_more" class="cardview_vendor"
        *ngIf="!showAllVendors && vendorsWithActivePromotions.length > 3" (click)="showAllVendors = !showAllVendors">
        <ion-row class="ion-align-items-center">
          <ion-col size="9">
            <div>
              <p>Vezi toate promotiile</p>
            </div>
          </ion-col>
          <ion-col size="3">
            <ion-icon color="tertiary" name="chevron-forward-outline"></ion-icon>
          </ion-col>
        </ion-row>
      </ion-card> -->
    </div>
  </div>

  <!-- Section Preview Vendor/Products -->
  <div *ngIf="searchedVendorsList">
    <ion-row class="ion-align-items-center section_header">
      <ion-col>
        <p class="section_title">Produse</p>
      </ion-col>
      <ion-col size="auto">
        <ion-button color="primary" fill="clear" shape="round" size="small" (click)="cancelSearch()">
          Inapoi
        </ion-button>
      </ion-col>
    </ion-row>
    <app-vendors-list [vendorsList]="searchedVendorsList" (eventSelectVendor)="receiveEventSelectVendor($event)"></app-vendors-list>
  </div>

  <!-- Section Follow us -->
  <ion-row id="row_comunity" class="ion-align-items-center" *ngIf="vendorsList">
    <ion-col size="auto">
      <p>Follow us</p>
    </ion-col>
    <ion-col size="auto">
      <ion-button fill="clear" shape="round" color="tertiary">
        <ion-icon slot="icon-only" name="logo-facebook"></ion-icon>
      </ion-button>
    </ion-col>
    <ion-col size="auto">
      <ion-button fill="clear" shape="round" color="tertiary">
        <ion-icon slot="icon-only" name="logo-instagram"></ion-icon>
      </ion-button>
    </ion-col>
    <ion-col size="auto">
      <ion-button fill="clear" shape="round" color="tertiary">
        <ion-icon slot="icon-only" name="logo-youtube"></ion-icon>
      </ion-button>
    </ion-col>
  </ion-row>
</ion-content>